promotion <- tibble(male = rbinom(25, size = 1, prob = 0.7), female = rbinom(25, size = 1, prob = 0.4))
library(tidyverse)
promotion <- tibble(male = rbinom(25, size = 1, prob = 0.7), female = rbinom(25, size = 1, prob = 0.4))
promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(promoted) %>% count()
promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(gender, promoted) %>% tally()
promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(gender, promoted) %>% tally() %>% spread(promoted)
promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(gender, promoted) %>% tally() %>% spread(promoted, n)
promotion <- promotion %>% mutate(male = ifelse(male==1, 'promoted', 'not promoted')) %>% mutate(female = ifelse(male==1, 'promoted', 'not promoted'))
promotion
write_csv(promotion, 'lab10.csv')
promotion <- read_csv('lab10.csv')
fisher.test(promotion)
fisher.test(promotion$male, promotion$female)
promotion_crosstab <- promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(gender, promoted) %>% tally() %>% spread(promoted, n)
promotion_crosstab
table(promotion$female)
promotion <- tibble(male = rbinom(25, size = 1, prob = 0.7), female = rbinom(25, size = 1, prob = 0.4))
promotion_crosstab <- promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(gender, promoted) %>% tally() %>% spread(promoted, n)
promotion_crosstab
promotion <- promotion %>% mutate(male = ifelse(male==1, 'promoted', 'not promoted')) %>% mutate(female =  ifelse(female==1,'promoted', 'not promoted'))
promotion_crosstab <- promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(gender, promoted) %>% tally() %>% spread(promoted, n)
promotion_crosstab
promotion <- tibble(male = rbinom(25, size = 1, prob = 0.7), female = rbinom(25, size = 1, prob = 0.4))
promotion <- promotion %>% mutate(male = ifelse(male==1, 'promoted', 'not promoted')) %>% mutate(female =  ifelse(female==1,'promoted', 'not promoted'))
promotion_crosstab <- promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(gender, promoted) %>% tally() %>% spread(promoted, n)
promotion_crosstab
write_csv(promotion,'lab10t.csv')
promotion <- read_csv('lab10t.csv')
promotion_crosstab <- promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(gender, promoted) %>% tally() %>% spread(promoted, n)
promotion_crosstab
promotion_crosstab <- promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(gender, promoted) %>% tally() %>% spread(gender, n)
promotion_crosstab
table(promotion$female)
fisher_crosstab <- promotion_crosstab %>% mutate(margin = female + male) %>% add_row(sum(promotion_crosstab$female, sum(promotion_crosstab$male), sum(promotion_crosstab$margin)))
fisher_crosstab <- promotion_crosstab %>% mutate(margin = female + male) %>% print()
fisher_crosstab <- promotion_crosstab %>% rowwise() %>% mutate(margin = sum())
fisher_crosstab
fisher_crosstab <- promotion_crosstab %>% rowwise() %>% mutate(margin = sum()) %>% columnwise()
fisher_crosstab <- promotion_crosstab %>% rowwise() %>% mutate(margin = sum()) %>% rowwise()
fisher_crosstab
fisher_crosstab <- promotion_crosstab %>% rowwise() %>% mutate(margin = female+male) %>% add_row(sum(female), sum(male), sum(margin))
fisher_crosstab <- promotion_crosstab %>% rowwise() %>% mutate(margin = female+male) %>% add_row(sum(fisher_crosstab$female), sum(fisher_crosstab$male), sum(fisher_crosstab$margin))
fisher_crosstab <- promotion_crosstab %>% rowwise() %>% mutate(margin = female+male)
fisher_crosstab <- fisher_crosstab %>% add_row(sum(fisher_crosstab$female), sum(fisher_crosstab$male), sum(fisher_crosstab$margin))
fisher_crosstab <- promotion_crosstab %>% rowwise() %>% mutate(margin = female+male)
fisher_crosstab <- fisher_crosstab %>% add_row(female = sum(fisher_crosstab$female), male = sum(fisher_crosstab$male), margin = sum(fisher_crosstab$margin))
fisher_crosstab
fisher_crosstab <- promotion_crosstab %>% rowwise() %>% mutate(margin = female+male)
fisher_crosstab <- fisher_crosstab %>% add_row(promoted = 'margin', female = sum(fisher_crosstab$female), male = sum(fisher_crosstab$male), margin = sum(fisher_crosstab$margin))
fisher_crosstab
fisher.test(promotion_crosstab[1,2:3], promotion_crosstab[2, 2:3])
fisher.test(promotion_crosstab[,2:3])
phyper(17, 28, 22, 25)
phyper(17, 28, 25, 25)
phyper(17, 22, 28, 25)
phyper(17, 22, 28, 25)
phyper(0, 22, 28, 25)
phyper(1, 22, 28, 25)
phyper(2, 22, 28, 25)
p_tab <- tibble(numbers=1:25) %>% mutate(phyper(number, 22, 28, 25))
p_tab <- tibble(numbers=1:25) %>% mutate(phyper(numbers, 22, 28, 25))
p_tab
p_tab <- tibble(numbers=1:25) %>% mutate(round(phyper(numbers, 22, 28, 25),2))
p_tab
p_tab <- tibble(numbers=1:25) %>% mutate(prob = round(phyper(numbers, 22, 28, 25),2))
p_tab
p_tab <- tibble(numbers=1:25) %>% mutate(prob = round(dhyper(numbers, 22, 28, 25),2))
p_tab
library(tidyverse)
promotion <- read_csv('lab10t.csv')
promotion_crosstab <- promotion %>% pivot_longer(1:2, names_to = "gender", values_to = "promoted") %>% group_by(gender, promoted) %>% tally() %>% spread(gender, n)
promotion_crosstab
fisher_crosstab <- promotion_crosstab %>% rowwise() %>% mutate(margin = female+male)
fisher_crosstab <- fisher_crosstab %>% add_row(promoted = 'margin', female = sum(fisher_crosstab$female), male = sum(fisher_crosstab$male), margin = sum(fisher_crosstab$margin))
fisher_crosstab
p_tab <- tibble(numbers=1:25) %>% mutate(prob = round(dhyper(numbers, 22, 28, 25),2))
p_tab
fisher.test(promotion_crosstab[,2:3])
transport <- tibble(transport = c('bike','mass_transit','walk','car'), house = c(30, 81, 11, 254) , flat = c(70,118, 44,98)) %>% print()
write_csv(transport,'lab10g.csv')
chisq.test(transport[,2:3])
transport <- read_csv('lab10g.csv')
transport <- read_csv('lab10g.csv')
